import os
import numpy as np
from math import sqrt, ceil
import cv2
import subprocess

def identify_packer(file_path):
    try:
        # Exécute la commande PEiD en mode avancé pour identifier le packer
        result = subprocess.run(['peid', file_path], capture_output=True, text=True, check=True)

        # Affiche la sortie de PEiD
        print(result.stdout)
        
        # Liste des 10 packers les plus utilisés
        top_packers = ['UPX', 'ASPack', 'PECompact', 'NSPack', 'FSG', 'RLPack', 'Morphine', 'ExeCryptor', 'Yoda', 'MEW']

        # Vérifie si l'un des 10 packers est présent dans la sortie
        for packer in top_packers:
            if packer in result.stdout:
                print(f"{packer} Found!")
    except subprocess.CalledProcessError as e:
        # En cas d'erreur, affiche le message d'erreur
        print(f"Erreur lors de l'identification du packer : {e.stderr}")


# Exemple d'utilisation
peid_path = 'C:\\Users\\cocol\\Documents\\HEH2023\\MachineLearning\\Projet\\app-peid\\PEiD.exe'  # Remplacez par le chemin vers votre exécutable PEiD
# file_path = 'C:\\Users\\cocol\\Documents\\HEH 2023\\MachineLearning\\Projet\\heh-cybersecurity-2023-2024\\trainset\\trainset\\safe\\17.exe'  # Remplacez par le chemin vers votre fichier exécutable
# file_path = 'C:\\Users\\cocol\\Documents\\HEH2023\\MachineLearning\\Projet\\heh-cybersecurity-2023-2024\\trainset\\trainset\\malware\\0.exe'  # Remplacez par le chemin vers votre fichier exécutable
file_path = 'C:\\Users\\cocol\\Documents\\HEH2023\\MachineLearning\\Projet\\tesUPX\\17.exe'  # Remplacez par le chemin vers votre fichier exécutable

identify_packer(file_path)
